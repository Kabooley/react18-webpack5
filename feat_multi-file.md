# Note: Multiple editor

Note for `feat_multi-file` branch.

基本：

- fileごとにmonacoのmodelを生成する
- model毎に値などを保持しておく
- fileの切り替えごとにmodelをeditorInstance.setModel(model)すれば切り替わる

## 参考



https://github.com/Microsoft/monaco-editor/issues/604#issuecomment-344214706

https://stackoverflow.com/questions/53900950/tabs-in-monaco-editor

## 実装

- マルチファイルエディタ
- 開いている最中のファイルのタブ
- saveViewState, restoreViewState


#### 実装：file 

ひとまず、buttonを設置して、

各ボタンをクリック　--> fileが切り替わる

という仕様にする。



#### 実装：Tabs

editorで現在開いている最中のファイルのタブ

https://github.com/Microsoft/monaco-editor/issues/604#issuecomment-344214706

https://github.com/Microsoft/monaco-editor/blob/bad3c34056624dca34ac8be5028ae3454172125c/website/playground/playground.js#L108

https://microsoft.github.io/monaco-editor/docs.html#interfaces/editor.IStandaloneCodeEditor.html#restoreViewState

ファイルを切り替えたときに、切り替得る前のmodelのviewを保存するのに使う

> Restores the view state of the editor from a serializable object generated by `saveViewState`.

https://microsoft.github.io/monaco-editor/typedoc/interfaces/editor.IStandaloneCodeEditor.html#saveViewState

現在のmodelのviewを保存しておく。

> Saves current view state of the editor in a serializable object.


#### とにかくつくってみる

MonacoEditor component:

- props.currentModel: 

親コンポーネントから、どのタブがまたはファイルが選択されたのかの情報を受け取る

useEffect(, [props.currentModel])が、initializeFileとchangeModelを呼び出す

initializeFileはmodelの生成、modelのキャッシュ

changeModel()は、
    saveViewStateで現在のmodelのviewstateを保存する
    setModelで新しいmodelをエディタに反映させる
    restoreViewStateで切り替わったmodelのstateを反映させる



```css
.tab-area {
    position: absolute;
    box-sizing: border-box;
    top: 0;
    left: 0;
	height: 20px;
	box-sizing: border-box;
	border-bottom: 1px solid #999;
}

.tab {
	height: 20px;
	line-height: 20px;
	box-sizing: border-box;
	color: #999;
	padding: 0 8px;
	border: 1px solid #999;
	border-bottom: 0;
	cursor: pointer;
	float: left;
}

.tab.active {
	color: black;
	border-bottom: 1px solid white;
    background-color: violet;
}
```

## 他

#### webpack: 無視するディレクトリの指定の仕方

TODO: evacuationを指定すること

#### iframeでのコードの埋め込み方

Microsoftのやりかたがここに載っていた～

https://github.com/microsoft/monaco-editor/blob/bad3c34056624dca34ac8be5028ae3454172125c/website/playground/playground.js

